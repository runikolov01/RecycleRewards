<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ü–µ—á–µ–ª–∏–≤—à–∏</title>
    <link href="images/logo-removebg-preview.png" rel="icon" type="image/png">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>

<div th:replace="~{fragments/navbar}"></div>

<div class="container mt-5">
    <div class="jumbotron p-4">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="display-4">–ü–µ—á–µ–ª–∏–≤—à–∏ –æ—Ç —Ç–æ–º–±–æ–ª–∏üéÅ</h1>
            <div th:if="${loggedIn != null and loggedUser != null and loggedIn and loggedUser.role == T(com.fcst.student.RecycleRewards.model.enums.Role).ADMIN}">
                <a class="btn-sm btn-primary" href="/admin_raffle">–¢–µ–≥–ª–µ–Ω–µ –Ω–∞ –ø–µ—á–µ–ª–∏–≤—à–∏—Ç–µ –æ—Ç —Ç–æ–º–±–æ–ª–∏—Ç–µ</a>
            </div>
        </div>
        <hr class="my-4">
        <p>–ù–µ –∑–∞–±—Ä–∞–≤—è–π—Ç–µ, —á–µ –º–æ–∂–µ—Ç–µ –¥–∞ —Å–æ—Ä—Ç–∏—Ä–∞—Ç–µ —Ä–µ–¥–æ–≤–µ—Ç–µ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∫–∞—Ç–æ –Ω–∞—Ç–∏—Å–Ω–µ—Ç–µ –≤—ä—Ä—Ö—É –∏–º–µ—Ç–æ –Ω–∞ –∫–æ–ª–æ–Ω–∞—Ç–∞, –ø–æ
            –∫–æ—è—Ç–æ –∂–µ–ª–∞–µ—Ç–µ –¥–∞ —Å–æ—Ä—Ç–∏—Ä–∞—Ç–µ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –≤–µ–¥–Ω—ä–∂, –∑–∞ –¥–∞ —Å–æ—Ä—Ç–∏—Ä–∞—Ç–µ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–ª–æ–Ω–∞—Ç–∞ –ø–æ –∞–∑–±—É—á–µ–Ω —Ä–µ–¥, –∞ –ø—Ä–∏
            –ø–æ–≤—Ç–æ—Ä–Ω–æ
            –Ω–∞—Ç–∏—Å–∫–∞–Ω–µ: –ø–æ –æ–±—Ä–∞—Ç–µ–Ω —Ä–µ–¥.</p>
        <div id="wonPrizes" style="display: block;">
            <div style="overflow-x:auto; overflow-y:auto; max-height: 400px;">
                <table class="table table-striped table-bordered">
                    <thead>
                    <tr>
                        <th class="text-center" scope="col">–ù–∞–≥—Ä–∞–¥–∞ ‚Ññ</th>
                        <th class="text-center" scope="col">–î–∞—Ç–∞ –Ω–∞ —Ç–µ–≥–ª–µ–Ω–µ</th>
                        <th class="text-center" scope="col">–ù–∞–≥—Ä–∞–¥–∞</th>
                        <th class="text-center" scope="col">–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th class="text-center" scope="col">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª ‚Ññ</th>
                        <th class="text-center" scope="col">–ò–º–µ</th>
                        <th class="text-center" scope="col">–§–∞–º–∏–ª–∏—è</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="prize : ${wonPrizes}"
                        th:if="${prize.prize.getType() == T(com.fcst.student.RecycleRewards.model.enums.PrizeType).RAFFLE}">
                        <td><span class="text-center" th:text="${prize.prize.prizeCode}"></span></td>
                        <td><span class="text-center"
                                  th:text="${#temporals.format(prize.prize.endDate, 'yyyy-MM-dd')}"></span></td>
                        <td><span class="text-center" th:text="${prize.prize.name}"></span></td>
                        <td><span class="text-center" th:text="${prize.prize.description}"></span></td>
                        <td><span class="text-center" th:text="${prize.user.userCode}"></span></td>
                        <td><span class="text-center" th:text="${prize.user.firstName}"></span></td>
                        <td><span class="text-center" th:text="${prize.user.lastName}"></span></td>
                    </tr>
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>


<div th:replace="~{fragments/footer}"></div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    $(document).ready(function () {
        // Event handler for sorting by column
        var sortOrders = {}; // Object to track sorting orders for each column

        $('th').on('click', function () {
            var columnIndex = $(this).index(); // Get the index of the clicked column

            // Toggle sorting order or set to ascending if not already set
            sortOrders[columnIndex] = (sortOrders[columnIndex] === 'asc') ? 'desc' : 'asc';

            // Get the table body
            var $tbody = $('table tbody');

            // Sort the rows based on the clicked column
            var rows = $tbody.find('tr').toArray();
            rows.sort(function (a, b) {
                var valueA = $(a).find('td:eq(' + columnIndex + ') span').text();
                var valueB = $(b).find('td:eq(' + columnIndex + ') span').text();


                if (sortOrders[columnIndex] === 'asc') {
                    return (valueA < valueB) ? -1 : (valueA > valueB) ? 1 : 0;
                } else {
                    return (valueA > valueB) ? -1 : (valueA < valueB) ? 1 : 0;
                }
            });

            // Reorder the rows in the table
            $.each(rows, function (index, row) {
                $tbody.append(row);
            });
        });
    });
</script>

</body>

</html>